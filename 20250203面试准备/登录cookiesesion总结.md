1. **认证与授权**：认证（Authentication）是验证用户身份的凭据，确认 “你是谁”；授权（Authorization）发生在认证之后，掌管用户访问系统的权限，确定 “你有权限干什么”。系统常结合两者保障安全性，RBAC 模型是常用的权限控制模型，通过 “用户 - 角色 - 权限” 关联简化权限管理。
2. Cookie 与 Session
   - **Cookie**：是网站存于用户本地终端的数据，用于保存用户信息。可实现自动登录、记录用户偏好，还能存储 SessionId 或 Token ，帮助后端记录用户状态，也可用于记录和分析用户行为。在 Spring Boot 项目中，可设置、获取 Cookie 值。
   - **Session**：主要在服务端记录用户状态，如购物车场景。与 Cookie 不同，其数据保存在服务器端，安全性更高。可通过 SessionID 实现身份验证，将 SessionID 存于 Redis，用户登录后，服务器创建 Session 并返回 SessionID 至客户端 Cookie，后续请求携带该 ID 进行身份验证。
3. 安全机制问题及解决方案
   - **CSRF 攻击**：Cookie 无法防止 CSRF 攻击，因为攻击者可利用浏览器自动发送 Cookie 中 SessionId 的特性，诱导用户点击恶意链接进行非法请求。而 Token 存于 localStorage，请求时手动添加，非法请求无 Token 则无法通过验证。
   - **多服务器节点下 Session - Cookie 方案**：单体环境中 Session - Cookie 方案良好，但多节点时会因用户请求被转发到不同服务器导致 Session 信息不一致，用户需重新登录。可采用特定哈希策略、服务器间同步 Session 信息或使用共享数据节点（如 Redis）存储 Session 信息等方案解决，Spring Session 可实现分布式会话管理。
4. **其他概念**：JWT（JSON Web Token）是一种身份验证技术，文档提及了相关基础概念。SSO（单点登录）允许用户登录一个子系统后访问其他相关系统，对用户、管理员和新系统开发都有好处。OAuth 2.0 是行业标准授权协议，用于授权第三方应用获取有限权限，常见于第三方登录、支付和开发平台等场景。
5. **JWT 定义**：即 JSON Web Token，是流行的跨域认证方案，基于 Token 的认证授权机制，符合 RESTful API 无状态原则，能减轻服务端压力、避免 CSRF 攻击。
6. **JWT 组成**：由 Header、Payload、Signature 三部分构成，通过 “.” 分隔。Header 含令牌类型和签名算法；Payload 存放数据，包含多种声明；Signature 用于防止篡改，由特定计算生成。
7. **身份验证流程**：用户登录提供信息，校验通过后服务端返回 JWT，客户端保存后每次请求携带，服务端据此获取用户信息。建议存于 localStorage，放在 HTTP Header 的 Authorization 字段。
8. **安全性保障**：签名可防篡改，服务端对比新生成与原 Signature 判断是否被改。加强安全性需用高安全算法、成熟开源库，合理存放 JWT，不存隐私信息，保管好密钥，设置合理过期时间
9. JWT 优势
   - **无状态**：自身包含身份验证信息，减轻服务端压力，但导致不可控，如废弃或更改权限不能立即生效1。
   - **避免 CSRF 攻击**：不依赖 Cookie，减少跨站请求伪造风险，但存在 XSS 攻击风险，可通过过滤可疑字符串防范2。
   - **适合移动端应用**：不依赖服务器端状态管理和 Cookie，可跨语言使用，更适配移动端3。
   - **单点登录友好**：保存在客户端，不存在 Session 认证中 Cookie 跨域等问题4。
10. JWT 常见问题及解决办法
    - **注销登录等场景下 JWT 还有效**：可采用将 JWT 存入数据库、黑名单机制、修改密钥、保持令牌有效期短并经常轮换等方案解决5。
    - **JWT 的续签问题**：有类似 Session 认证、每次请求都返回新 JWT、有效期设置到半夜、用户登录返回两个 JWT 等解决方式，其中返回两个 JWT 的方式相对推荐6。
    - **JWT 体积太大**：通过减少 Payload 信息、使用压缩算法或选择传统 Token 等方式解决7。
11. **总结**：JWT 虽有无状态优势，但实际使用可能仍需保存信息。其存在缺陷，应根据项目需求选择 JWT、Session 或普通 Token 结合 Redis 等身份认证方案。
12. SSO 基础概念
    - **定义**：英文全称 Single Sign On，指在多个应用系统中，用户只需登录一次就能访问所有相互信任的应用系统，如登录网易账号中心后，访问网易旗下多个站点都处于登录状态。
    - **好处**：对用户而言，一次登录多次使用，无需记忆多套账号密码；对系统管理员来说，只需维护统一账号中心；新系统开发时，直接对接统一账号中心，简化开发流程。
13. SSO 设计与实现
    - **核心功能**：涵盖单点登录、单点登出、支持跨域单点登录和跨域单点登出。
    - **核心应用与依赖**：包括前台站点、SSO 站点（登录、登出）、SSO 服务（登录、登录状态、登出）、数据库（存储用户账户信息）、缓存（常用 Redis 存储用户登录信息）。
    - **用户登录状态处理**：用户登录成功生成 AuthToken，浏览器端存于 Cookie，手机 App 存于本地缓存。通过 Redis 集群存储登录信息，保证高可用和可扩展性。AuthToken 可使用 UUID/GUID，也可由 UserName + 时间戳加密生成。
    - 登录、登出流程
      - **登录**：用户登录后 AuthToken 存于 Cookie，浏览器设置 domain 为特定值，访问相关站点时携带 AuthToken 到服务器端，经 SSO 服务校验状态和获取登录信息。
      - **登出**：服务端清除 Redis 中的登录状态，客户端清除 AuthToken。
    - **跨域登录、登出**：通过回调方式传递 AuthToken 实现跨域登录，即登录后将 AuthToken 传给其他站点保存；登出时通过回调调用其他站点登出页面，使 Cookie 中的 AuthToken 过期。
14. **补充说明**：方案提供实现思路，涉及 APP 用户登录时，访问 SSO 服务可增加签名验证；时序图展示核心场景，省略部分不影响理解的消息。
15. **老权限系统问题**：转转此前无统一权限管理系统，各业务自行研发或借用其他系统，导致重复开发、维护成本高，方案通用性差，且缺乏统一日志管理和审批流程，授权信息追溯困难12。
16. 业界权限系统设计方式
    - **RBAC 模型**：基于角色授权，构建 “用户 - 角色 - 权限” 模型，用户与角色、角色与权限多对多关联，可简化权限管理。如 Gitlab 权限系统，授予用户 Admin 角色，用户便拥有创建和删除代码仓库权限。
    - **ABAC 模型**：依据用户、资源、环境等属性动态判断操作权限，更灵活，能处理复杂场景，但 RBAC 难以实现。如授权编辑特定书籍、根据文档所属部门控制访问等场景。
17. 新权限系统设计
    - **设计思想**：结合业务，选用 RBAC 模型，在其基础上增加直接给用户添加权限的功能，用户最终权限为角色和独立配置权限的并集。
    - **系统架构**：统一管理集团用户，打通组织架构；支持多系统权限管理，用户先选系统，再配置菜单和数据权限，创建角色并配置权限点，之后可通过两种方式给用户授权。
    - **权限管理**：权限系统用户分超级管理员、权限操作用户和普通用户三类；权限分为菜单功能权限和数据权限；各系统设超级管理员、系统管理员、授权管理员三个默认角色。
18. **核心模块设计**：包括系统 / 菜单 / 数据权限管理、角色与用户管理、权限申请、操作日志等模块，各模块协同实现权限的全面管理和记录。